<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WebGPU Music-Reactive Image Mosaic</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div id="app">
      <canvas id="canvas"></canvas>
      <div id="controls">
        <div id="audio-controls">
          <label>
            Audio Input:
            <select id="audio-input-select">
              <option value="">Select Audio Device</option>
            </select>
          </label>
          <button id="start-audio">Start Audio</button>
          <button id="stop-audio" disabled>Stop Audio</button>
        </div>
        
        <div id="visual-controls">
          <label>
            Grid Tile Size:
            <input type="range" id="tile-size" min="16" max="64" value="32" />
            <span id="tile-size-value">32px</span>
          </label>
          
          <label>
            Distortion Strength:
            <input type="range" id="distortion-strength" min="0" max="2" step="0.1" value="1.0" />
            <span id="distortion-strength-value">1.0</span>
          </label>
          
          <label>
            Cycle Duration:
            <input type="range" id="cycle-duration" min="10" max="60" value="30" />
            <span id="cycle-duration-value">30s</span>
          </label>
          
          <label>
            Silence Threshold:
            <input type="range" id="silence-threshold" min="0.001" max="0.1" step="0.001" value="0.01" />
            <span id="silence-threshold-value">0.01</span>
          </label>
        </div>
        
        <div id="debug-controls">
          <button id="next-image">Next Image</button>
          <button id="freeze-audio">Freeze Audio</button>
        </div>
        
        <div id="status">
          <div id="fps">FPS: 0</div>
          <div id="rms">RMS: 0.000</div>
          <div id="state">State: BOOT</div>
          <div id="audio-bands">
            <div>Low: <span id="low-band">0.0</span></div>
            <div>Mid: <span id="mid-band">0.0</span></div>
            <div>High: <span id="high-band">0.0</span></div>
          </div>
        </div>
      </div>
      
      <div id="overlay" class="hidden">
        <div id="overlay-content">
          <h2>Audio Permission Required</h2>
          <p>Please allow microphone access to enable audio-reactive visuals.</p>
          <button id="enable-audio">Enable Audio</button>
          <button id="visualize-without-audio">Visualize Without Audio</button>
        </div>
      </div>
    </div>
    
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>